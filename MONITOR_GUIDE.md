# 监控面板使用指南

## 概述

新的监控面板整合了活跃请求、Token记录和请求历史，提供统一的请求记录表格，实时显示服务状态和性能指标。

## 访问监控面板

启动服务后，在浏览器中访问：
```
http://localhost:3000/monitor/
```

## 主要功能

### 1. 服务状态总览

- **服务状态**: 显示运行状态和运行时间
- **实例信息**: 显示浏览器实例使用情况和利用率
- **请求统计**: 总请求数、成功/失败数、活跃请求数、成功率
- **内存信息**: 进程内存使用和系统内存状态

### 2. 性能指标图表

- **实时图表**: 响应时间、活跃请求、成功率趋势
- **性能指标**: 平均响应时间、每分钟请求数、成功率、活跃连接数
- **自动更新**: 每3秒刷新一次数据

### 3. 统一请求记录表格

新的表格格式：**时间 | URL | 状态 | Token | 响应时间**

#### 状态说明
- **处理中** 🟡: 请求正在处理，显示实时响应时间
- **已完成** 🟢: 请求成功完成
- **失败** 🔴: 请求处理失败

#### Token显示
- 自动关联请求和生成的Token
- Token显示为缩略形式（前20个字符）
- 鼠标悬停显示完整Token
- 无Token的请求显示 "-"

#### 特色功能
- **实时高亮**: 处理中的请求有黄色背景动画
- **智能排序**: 按时间倒序，最新请求在顶部
- **数据限制**: 显示最近50条记录，避免页面过载
- **详细信息**: URL支持悬停显示完整地址

## 使用场景

### 1. 实时监控
监控面板每3秒自动刷新，可以实时查看：
- 当前处理中的请求
- 最新完成的请求结果
- 系统性能状态

### 2. 性能分析
通过图表和统计数据分析：
- 响应时间趋势
- 请求成功率
- 系统负载情况
- 内存使用状况

### 3. 调试辅助
当请求失败时，可以：
- 查看失败请求的URL和模式
- 检查响应时间是否超时
- 分析失败率是否过高

## API接口

### 获取监控数据
```bash
curl http://localhost:3000/api/monitor
```

### 重置监控数据
```bash
curl -X POST http://localhost:3000/api/monitor/reset
```

### 健康检查
```bash
curl http://localhost:3000/health
```

## 演示工具

使用内置的演示脚本快速生成测试数据：

```bash
# 生成演示请求
python3 demo_monitor.py

# 运行完整测试
python3 test_service.py
```

## 性能优化建议

### 监控面板性能
- 自动暂停不可见页面的更新
- 限制历史记录数量避免内存溢出
- 使用高效的DOM更新机制

### 服务性能监控
- 关注响应时间超过10秒的请求
- 监控成功率低于90%的情况
- 检查内存使用超过80%的警告

## 故障排除

### 常见问题

1. **监控数据不更新**
   - 检查服务是否正常运行
   - 确认网络连接正常
   - 查看浏览器控制台错误信息

2. **图表显示异常**
   - 刷新页面重新初始化图表
   - 检查Canvas支持
   - 确认JavaScript未被阻止

3. **请求记录缺失**
   - 检查请求是否成功到达服务
   - 确认监控数据未被意外重置
   - 验证API端点可访问性

### 调试技巧

- 打开浏览器开发者工具查看网络请求
- 检查控制台是否有JavaScript错误
- 使用API接口直接验证数据

## 最佳实践

1. **定期检查监控面板**，特别是在高负载期间
2. **关注成功率下降**，及时调查失败原因
3. **监控内存使用**，防止内存泄漏
4. **定期重置数据**，保持界面清爽
5. **使用演示工具**测试新功能

---

💡 **提示**: 监控面板设计为轻量级实时监控工具，适合开发调试和生产监控使用。